# Rust 学习笔记

这篇学习笔记将用于记录本人在学习 Rust 编程语言过程中所编写的学习心得与代码。为此，我会在`https://github.com/owlman/study_note`项目的`Programming/Language/`目录下创建一个名为的`Rust`目录，并在该目录下设置以下两个子目录：

- `note`目录用于存放`markdown`格式的笔记。
- `code`目录则用于存放笔记中所记录的代码示例。

## 学习规划

- 学习基础：有 C/C++/JavaScript/Python 等编程语言的使用经验。
- 学习资料：
  - 书籍教材：[《Rust 权威指南》](https://book.douban.com/subject/35081743/)、[《精通 Rust》](https://book.douban.com/subject/35290878/)
  - 视频资料：[Rust 编程语言教程视频](https://www.bilibili.com/video/BV1hp4y1k7SV?spm_id_from=333.999.0.0)
- 学习目标：
  - 开发一个基于 RESTful 架构的服务端应用。

## 前导部分：背景知识准备

### Rust 语言的起源故事

Rust 最早是 Mozilla 雇员 Graydon Hoare 的一个个人项目，从 2009 年开始，得到了 Mozilla 研究院的支助，2010 年项目对外公布。2010 ～2011 年间实现的自举。从此以后，Rust 经历了巨大的设计变化和反复（历程极其艰辛），终于在 2015 年 5 月 15日发布了 1.0 版。在这个研发过程中，Rust 建立了一个强大活跃的社区，形成了一整套完善稳定的项目贡献机制（这是真正的可怕之处）。Rust 现在由 Rust 项目开发者社区（https://github.com/rust-lang/rust ）维护。

Rust 能得到 Mozilla 研究院的支持，是因为 Mozilla 在开发和维护 Firefox 的 Gecko 引擎的时候，对于这样一个由 C++ 写的维护了20多年的，累计上千万行的代码库，已经不胜厌烦。由于历史包袱及各种漏洞、性能瓶颈，Firefox 已经远远落后竞争对手 Google Chrome 了。Mozilla 亟需一种能够安全编程的语言来重新让 Firefox 能跟上并超越时代。于是 Rust 项目就被资助并坚持孵化，直到发布 1.0。

影响了 Rust 的流行的编程语言包括 C, C++, C#, Erlang, Haskell, OCaml, Ruby, Scheme 和 Swift 等等。Rust 也影响了 C# 7, Elm, Idris, Swift。

### Rust 语言的优劣分析

### Rust 语言环境的安装

由于 Rust 的语言环境是基于 C/C++ 编译工具来构建的，这意味着在安装语言环境之前，我们的计算机上至少需要先安装一个 C/C++ 编译工具。换句话说，如果该计算机上使用的是类 Linux 系统，它就需要先安装 GCC 或 clang。如果是 macOS 系统，则就需要先安装 Xcode。如果是 Windows，则需要先安装 Visual Studio 2013 或 MinGW 之类的 C/C++ 编译工具。

#### 下载并执行安装脚本

到目前为止，Rust 语言环境大体上都是通过安装脚本的形式来安装的。所以在确定安装了 C/C++ 编译工具之后，` 接下来要做的就是根据自己所在的操作系统来下载并执行 Rust 语言环境的安装脚本了。

- 在 Windows 下，我们只需在搜索引擎中搜索“rust”关键字或直接在 Web 浏览器的地址栏中输入`https://www.rust-lang.org/`这个 URL 即可进入到 Rust 语言的官方网站，然后通过点击首页中的“install”链接，就会看到如下页面：

  ![rust_install](img/rust_install.png)

  在该页面中，我们可以根据自己所在的平台来下载 32 位或 64 位版本的安装脚本（通常是一个名为`rustup-init.exe`的二进制文件）。待下载完成之后，我们就可以双击执行该安装脚本，并遵循屏幕上的指示来安装（对于初学者，只需一路选择默认选项即可）。如果是 Windows 的 Linux 子系统（WSL）用户，也只需要在终端中运行以下命令，并遵循屏幕上的指示来安装（对于初学者，只需一路选择默认选项即可）。

  ```bash
  # 可选步骤：设置国内下载镜像
  echo "export RUSTUP_DIST_SERVER=https://mirrors.ustc.edu.cn/rust-static" >> ~/.bashrc
  echo "export RUSTUP_UPDATE_ROOT=https://mirrors.ustc.edu.cn/rust-static/rustup" >> ~/.bashrc
  source .bashrc

  # 下载并执行安装脚本
  curl --proto '=https' --tlsv1.2 -sSf https://sh.rustup.rs | sh
  ```

- 在 UNIX/Linux 下，我们只需直接执行下面的 shell 代码，并遵循屏幕上的指示来安装（对于初学者，只需一路选择默认选项即可）。

  ```bash
  # 可选步骤：设置国内下载镜像
  echo "export RUSTUP_DIST_SERVER=https://mirrors.ustc.edu.cn/rust-static" >> ~/.bashrc
  echo "export RUSTUP_UPDATE_ROOT=https://mirrors.ustc.edu.cn/rust-static/rustup" >> ~/.bashrc
  source .bashrc

  # 下载并执行安装脚本
  curl --proto '=https' --tlsv1.2 -sSf https://sh.rustup.rs | sh

  # 安装完毕后刷新环境变量
  source ~/.cargo/env
  ```

待上述命令执行完成之后，我们可通过在终端中执行`rustc -V` 和`cargo -V`来查看是否能输出相应的版本信息。如果这两个命令输出了相应的版本信息，就证明 Rust 语言环境的安装和配置工作已经成功了一半了，接下来的任务是配置 Cargo 并安装相关插件。

#### 配置 Cargo

Cargo 是一个内置在 Rust 语言环境中的包管理器及项目构建工具，其作用类似于 Node.js 运行环境中的 NPM。也就是说，在开发 Rust 项目的过程中，我们可以使用 Cargo 包管理器来下载并管理当前项目所依赖的第三方程序库，以及完成项目的构建工作。

和 NPM 一样，Cargo 在默认情况下链接的是`https://crates.io/`这个官方的程序仓库。由于众所周知的原因，这个服务器位于国外的官方仓库的可用性非常容易受到各种不可抗力的影响，很多时候是不确定的，我们最好还是将其设置为国内的代理仓库。为此，我们需要将代理仓库的服务器地址写到 cargo 的配置文件中（该配置文件就叫“config”，没有扩展名，通常情况下位于`${HOME}/.cargo/`目录中）。在这里，我将其具体配置如下：

```bash
[source.crates-io]
registry = "https://github.com/rust-lang/crates.io-index"
# 指定镜像
replace-with = 'sjtu'

# 清华大学
[source.tuna]
registry = "https://mirrors.tuna.tsinghua.edu.cn/git/crates.io-index.git"

# 中国科学技术大学
[source.ustc]
registry = "git://mirrors.ustc.edu.cn/crates.io-index"

# 上海交通大学
[source.sjtu]
registry = "https://mirrors.sjtug.sjtu.edu.cn/git/crates.io-index"

# rustcc社区
[source.rustcc]
registry = "https://code.aliyun.com/rustcc/crates.io-index.git"
```

在配置完上述内容之后，可以通过执行`rustup update`命令来验证代理仓库是否可用。如果一切正常，该命令会将当前语言环境中的所有组件更新到最新版本。

#### 安装一些插件

因为代码提示racer的一些#future功能不能在稳定版使用，无法安装
所以安装nightly版本的rust 并设置默认版本

```bash
rustup install nightly
rustup default nightly
```

安装RLS组建

```bash
rustup component add rls --toolchain nightly
rustup component add rust-analysis --toolchain nightly
rustup component add rust-src --toolchain nightly
```

安装racer

```bash
cargo install racer
```

#### 集成开发环境

推荐使用vscode：`https://code.visualstudio.com/`
安装好vscode后，Ctrl + Shift + X 打开应用商店
搜索chinese安装中文语言包，搜索Rust (rls)官方的插件，基本上就OK可以撸代码了。

## 第 1 部分：Rust 编程语言基础

### 使用 Cargo 构建并运行项目

## 第 2 部分：编写本地应用程序

## 第 3 部分：编写网络应用程序
