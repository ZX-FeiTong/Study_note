# Vue.js 学习笔记

这篇学习笔记将记录一些我个人在学习 Vue.js 框架时所编写的程序代码与学习心得。为此，我会在`ProgrammingLanguage/JavaScript`目录下创建一个名为的`vuejs`目录，并在该目录下设置以下两个子目录：

- `note`目录用于存放`markdown`格式的笔记。
- `code`目录则用于存放笔记中所记录的程序代码。

## 学习规划

- 学习基础：
  - 掌握 HTML、CSS、JavaScript 相关的基础知识。
  - 掌握 npm 包管理器的基本用法。
  - 了解 B/S 应用程序架构的基本原理。
- 学习资料：
  - 视频教程：[黑马程序员之 Vue.js 教学视频](https://www.bilibili.com/video/BV12J411m7MG?p=1)
  - 线上文档：[Vue.js 官方教程](https://cn.vuejs.org/v2/guide/)
  - 参考书籍：[《深入浅出 Vue.js》](https://book.douban.com/subject/32581281/)
- 学习目标：
  - 开发一个"云端记事本"应用。

## 第 1 部分：了解 Vue.js 框架

这部分笔记将记录我对 Vue.js 框架的概念性了解，以及在项目中引入该框架的具体方法，并编写一个"Hello World"程序。

### Vue.js 简介

Vue.js 是一套用于构建用户界面的渐进式框架。该框架被设计为可以自底向上逐层应用，它的核心库只关注视图层，不仅易于上手，还便于与第三方库或既有项目整合。另一方面，当与现代化的工具链以及各种支持类库结合使用时，Vue.js 也完全能够为复杂的单页应用提供驱动。简而言之，Vue.js 具有以下特性：

1. 使用了传统 HTML 类似的模版语法，对于新手来说，或许更易于上手。
2. 使用了虚拟的 DOM 模型，简化了对页面元素的操作方式。
3. 使用了响应式的视图组件，有助于提高程序界面的用户体验。
4. 页面渲染速度极快，能赋予应用程序良好的执行性能。
5. 既可以像 React 一样提供用于构建复杂大型应用的路由接口。
6. 也可以像 jQuery 一样提供使用简单、且封装良好的操作接口。

当然，由于 Vue.js 的作者本身是一个中国人，所以 Vue.js 社区的中文资料也相比其他 JavaScript 框架社区要丰富一些，这对于很多习惯中文阅读的用户来说，或许也是选择使用这一框架的原因。

### 引入 Vue.js 框架

和大多数 JavaScript 前端程序库和应用框架一样，在自己的项目中引入 Vue.js 框架主要有 CDN 引用和本地引用两种方式，下面分别来学习一下它们。

#### CDN 引用

CDN 是内容分发网络（Content Delivery Network 或 Content Distribution Network）的缩写，这是一种利用现有的互联网络系统中最靠近目标用户的服务器，更快、更可靠地分发音乐、图片、视频、应用程序以及其他数据资料的方式，目的是提供高性能、可扩展性及低成本的网络内容传递给用户。换而言之，在使用 CDN 这种引用方式时，Vue.js 框架文件会被存储在指定的 CDN 服务网络的某个服务器节点上，由该服务来集中负责针对该框架文件的访问负载并维护该框架的版本，而我们只要在 HTML 文档的`<script>`标签中引用相应 CDN 服务的 URL 即可，像这样：

```HTML
<!-- 开发环境版本，包含了有帮助的命令行警告 -->
<script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>
<!-- 或者 -->
<!-- 生产环境版本，优化了文件大小和载入速度 -->
<script src="https://cdn.jsdelivr.net/npm/vue"></script>
```

在上述示例中，我测试了使用`cdn.jsdelivr.net`提供的 CDN 服务来引用 Vue.js 框架，这也是 Vue.js 官方教程中推荐的服务。至于是该引用开发环境的版本，还是生产环境的版本，这就要取决于具体的使用场景了。在通常情况下，我会选择在程序开发阶段引用反馈信息相对丰富的开发环境版本，而等到程序发布之时再切换至更追求执行效率的生产环境版本。下面来了解一下使用 CDN 这种引用方式的优势：

- CDN 的总承载量可以比单一骨干最大的带宽还要大。这使得内容分发网络可以承载的用户数量比起传统单一服务器多。
- CDN 服务器可以被放置到不同地点，这有助于减少计算机之间互连的流量，进而降低带宽成本。
- CDN 通常会指派较近、较顺畅的服务器节点将资料传输给用户。虽说距离并非影响传输的绝对因素，但这可以尽可能提高性能和用户体验。
- CDN 上存储的资料通常都会有异地备援，即当某个服务器故障时，系统将会调用其他邻近地区的服务器资料，以提高服务的可靠度。
- CDN 提供给服务提供者更多的控制权，即提供服务的人可以针对客户、地区，或是其他因素来做相应的调整。

当然了，这种引用方式归根结底都得依赖于网络环境，甚至很多时候是国外的网络环境，由于众所周知的原因，我们的网络环境经常会受到各种不可抗力的影响，所以我个人更倾向于将框架文件下载到本地来引用。

#### 本地引用

正如上面所说，如果想减少意外状况，最好的选择是将 Vue.js 的框架文件下载到本地，然后再引用它们。下载这类文件的方式有很多，现如今为了便于更新版本，人们通常会选择使用 npm 这类包管理器来下载 JavaScript 的各种程序库和应用框架。具体做法就是在之前创建的`code`目录下执行以下命令：

```bash
npm install vue --save
# 如果需要相应的权限，可以使用 sudo 命令来提权
```

如果安装过程一切顺利，接下来就只需要在 HTML 文档的`<script>`标签中引用框架文件的路径即可，像这样：

```HTML
<!-- 开发环境版本，包含了有帮助的命令行警告 -->
<script src="node_modules/vue/dist/vue.js"></script>
<!-- 或者 -->
<!-- 生产环境版本，优化了文件大小和载入速度 -->
<script src="node_modules/vue/dist/vue.min.js"></script>
```

在这里，选择开发环境版本还是生产环境版本的依据是一样的，就不再重复了。下面来验证一下框架文件是否被成功引入。

#### 程序验证

我将通过编写一个"Hello World"程序来验证 Vue.js 框架是否已被成功引入，具体步骤如下：

1. 在`code`目录下创建一个名为`01_sayHello`的项目目录，并在该目录下设置以下两个子目录：
   - `img`目录：用于存放图片资源。
   - `js`目录：用于存放自定义 JavaScript 脚本文件。

2. 将名为`logo.png`的图表文件存储到`code/01_sayHello/img`目录中。

3. 在`code/01_sayHello`目录中创建一个名为`index.htm`的 HTML 文档，并在其中输入如下代码：

   ```HTML
   <!DOCTYPE html>
   <html lang="zh-cn">
   <head>
       <meta charset="UTF-8">
       <meta name="viewport" content="width=device-width, initial-scale=1.0">
       <meta http-equiv="X-UA-Compatible" content="ie=edge">
       <script defer="defer" src="../node_modules/vue/dist/vue.js"></script>
       <script defer="defer" src="js/main.js"></script>
       <title>你好，Vue.js</title>
   </head>
   <body>
      <div id="app">
         <h1> {{ sayHello }} </h1>
         <img :src="vueLogo" style="width:200px">
      </div>
   </body>
   </html>
   ```

4. 在`code/01_sayHello/js`目录中创建一个名为`main.js`的 JavaScript 脚本文档，并在其中输入如下代码：

   ```JavaScript
   // 程序名称： sayHello
   // 实现目标：
   //   1. 验证 Vue.js 执行环境
   //   2. 体验构建 Vue.js 程序的基本步骤

   const app = new Vue({
      el: '#app',
      data:{
        sayHello: '你好，Vue.js！',
        vueLogo: 'img/logo.png'
      }
   });
   ```

接下来只需将相关的 Web 服务运行起来（该服务器可以是 Apache 或者 Nginx，也可以是 VSCode 的 Live Sever 插件），然后如果在 Web 浏览器中看到如下页面，就说明 Vue.js 框架已经被引入到了程序中，并被成功执行起来了。

   ![Hello_World](img/hello_vue.png)

## 第 2 部分：学习数据驱动开发

在 Vue.js 框架中，与 HTML 页面元素的交互方式没有像原生 JavaScript 接口那么直接，它是通过先在 HTML 元素标签中嵌入一系列类似于普通标签属性的 Vue 指令属性来绑定数据，然后再通过在 JavaScript 代码中修改这些被绑定的数据来修改页面元素的显示方式与内容。在编程方法上，我们通常将这种用数据内容的变化来驱动整个程序业务运作的方式称之为"**数据驱动开发**"。这部分笔记将记录如何利用数据驱动的开发方式来完成数据绑定、事件响应，以实现控制页面元素与 CSS 样式等各项基本功能。

### 数据绑定

在之前的`01_sayHello`程序中，我们现在`<h1>`标签中使用模版语法绑定了一个名称为`sayHello`的数据，该模版语法实际上是`v-text`指令的语法糖。换句话说，该`<h1>`标签更规范的语法应该是：

```HTML
<h1 v-text="sayHello"></h1>
```

考虑到我们传统上编写 HTML 标签的习惯，使用`{{ data_name }}`这样的模版标记会是更让人舒服的做法。当然了，`v-text`指令设置的是当前元素标签下面的文本内容，如果要为标签本身的属性绑定数据，就得要使用`v-bind`指令，具体语法是在要设置的标签属性名前面加上`v-bind:`前缀。例如，如果想为`<img>`标签的`src`属性绑定数据，就可以这样做：

```HTML
<img v-bind:src="vueLogo" style="width:200px">
```

另外，`v-bind`指令还有一个简写形式，只需要在要绑定数据的标签属性名之前加一个`:`前缀即可。在之前的`01_sayHello`程序中，我采用的就是这种形式。在页面元素上绑定了数据之后，接下来就可以在相对应的 JavaScript 脚本中创建 Vue 实例了，这就是我之前在`01_sayHello`程序的`main.js`文件中编写的内容。这个 Vue 实例对象中至少要定义以下两个成员：

- **`el`成员**：该成员用于设置当前 Vue 实例所对应的元素容器，这通常是一个`<div>`元素，某些情况也可以是 HTML5 提供的`<header>`、`<footer>`等容器类标签。该成员的值可以是任何一个符合 CSS 选择器语法的字符串，例如`#ID`、`.CLASSNAME`等。
- **`data`成员**：该成员用于设置页面元素中绑定的数据，它的值本身也是一个 JSON 格式的对象，该对象的每个成员都对应一个页面元素中绑定的对象，例如在之前的`01_sayHello`程序中，我绑定了`sayHello`和`vueLogo`这两个数据，就必须要在 Vue 对象的`data`成员中为为它们设置相应的值。

### 事件处理

当然，`01_sayHello`程序目前只是一个单向显示数据的业务。如果想要让其具备交互能力，还需要为页面元素绑定事件。在 Vue.js 框架中，绑定事件首先要通过`v-on`指令来为目标元素标签注册事件处理函数，例如如果我们想在`01_sayHello`程序用一个按钮来控制`<img>`元素的显示与否，可以将该程序的`index.htm`代码修改如下：

```HTML
<!DOCTYPE html>
<html lang="zh-cn">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <script defer="defer" src="../node_modules/vue/dist/vue.js"></script>
    <script defer="defer" src="js/main.js"></script>
    <title>你好，Vue.js</title>
</head>
<body>
    <div id="app">
        <h1> {{ sayHello }} </h1>
        <!-- 上述模版语法背后真正的 Vue 语法：
        <h1 v-text="sayHello"></h1>
        -->
        <img :src="vueLogo" v-show="isShow" style="width:200px">
        <!-- 上述简写指令的完整 Vue 语法：
        <img v-bind:src="vueLogo" style="width:200px">
        -->
        <input type="button" :value="isShow?'隐藏':'显示'" @click="toggleShow" />
        <!-- 上述简写指令的完整 Vue 语法：
        <input type="button" v-bind:value="isShow?'隐藏':'显示'" v-on:click="toggleShow" />
        -->
    </div>
</body>
</html>
```

在这里，我主要做了如下修改：

- 首先，在`<img>`标签中增加了一个`v-show`指令，该指令可用于绑定一个布尔类型的数据（即这里的`isShow`），以此来决定是否显示其所在的标签。
- 然后，在页面中新增了一个按钮标签，并用`v-bind`指令设置了该标签的`value`属性，该属性的值是一个条件表达式，它将根据`isShow`的值显示不同的文本。
- 最后，用`v-on`指令（`@`是该指令`v-on:`前缀的简写形式）为新增的按钮标签注册了一个名为`toggleShow`的单击事件处理函数。

下面继续来对`main.js`中的代码进行修改，具体如下：

```JavaScript
const app = new Vue({
    el: '#app',
    data:{
        sayHello: '你好，Vue.js！',
        vueLogo: 'img/logo.png',
        isShow: true
    },
    methods:{
        toggleShow: function() {
            this.isShow = !this.isShow;
        }
    }
});
```

在这里，我主要做了如下修改：

- 首先，在 Vue 对象的`data`成员中定义了之前绑定的布尔类型数据`isShow`，并将其默认值设置为 true。
- 然后，为 Vue 对象新增了一个名为`methods`的成员。该成员用于设置页面元素中注册的事件处理函数，它的值也是一个 JSON 格式的对象。该对象的每个成员都对应一个已在页面元素中用`v-on`指令注册的事件处理函数。在这里就是`toggleShow`，该函数每次调用都会将`isShow`的值取反。

这样一来，当我们在 Web 浏览器中打开该应用程序就会看到之前的 Vue 图标旁边多了个文本内容为`隐藏`的按钮。当按钮被单击之后，图标就会消失，按钮上的文本也变成`显示`。之后，如果该按钮再次被单击，一切又会恢复原状。

### 用户输入

对于用户来说，除了触发事件之外，允许用户在运行时输入具体的数据也是一个应用程序必不可少的一项功能。下面将通过编写一个"待办事项"的程序来学习如何使用 Vue.js 框架实现能处理用户输入数据的应用程序界面。为此，我需要在`code`目录下创建一个名为`02_toDoList`的目录，并在该目录中创建一个名为`index.htm`的文件，其代码如下：

```HTML
<!DOCTYPE html>
<html lang="zh-cn">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <script defer="defer" src="../node_modules/vue/dist/vue.js"></script>
    <script defer="defer" src="js/main.js"></script>
    <title>待办事项</title>
</head>
<body>
    <div id="app">
        <h1>待办事项</h1>
        <div id="todo">
            <ul>
                <li v-for="( task,index ) in taskList">
                    <input type="checkbox" v-model="doneList" :value="task">
                    <label :for="task">{{ task }}</label>
                    <input type="button" value="删除" @click="remove(index)">
                </li>
            </ul>
        </div>
        <div id="done" v-if="doneList.length > 0">
            <h2>已完成事项</h2>
            <ul>
                <li v-for="task in doneList">
                    <label :for="task">{{ task }}</label>
                </li>
            </ul>
        </div>
        <input type="text" v-model="newTask" @keyup.enter="addNew">
        <input type="button" value="添加新任务" @click="addNew">
    </div>
</body>
</html>
```

接下来，我会在同一目录下再创建一个名为`js`的目录，并在该目录下创建`main.js`脚本文件，其代码如下：

```JavaScript
// 程序名称： toDoList
// 实现目标：
//   1. 学习 v-model、v-for 等指令
//   2. 掌握如何处理用户输入

const app = new Vue({
    el: '#app',
    data:{
        newTask: '',
        taskList: [],
        doneList: []
    },
    methods:{
        addNew: function() {
                  if(this.newTask !== '') {
                      this.taskList.push(this.newTask);
                      this.newTask = '';
                  }
                },
        remove: function(index) {
                  if(index >=  0) {
                      this.taskList.splice(index,1);
                  }
                }
    }
});
```

下面来具体分析一下这个程序。在通常情况下，Web 应用程序在前端接受用户输入信息的方式主要有两种：第一种方式是用文本框元素来获取用户从键盘输入的信息。在 Vue.js 框架中，我们可以用`v-model`指令将`<input type="text">`标签绑定到`newTask`数据中，该指令与`v-bind`指令不同的在于，它是一种双向绑定。也就是说，`v-model`指令不止可以让 JavaScript 代码中对绑定数据的修改反映到页面元素中，也可以让页面元素获取到的用户输入数据同步到 JavaScript 代码中。在 JavaScript 代码获取到文本框中的用户输入内容之后，我们就可以通过事件处理函数`addNew`将其加入到一个名为`taskList`的数据列表中，然后将该事件处理函数注册给输入回车和鼠标单击事件。

第二种方式是用单选钮、复选框等选择性元素来获取用户用鼠标勾选的信息。例如在上面这个程序中，我在`<div id="todo">`元素中用`v-for`指令创建了一系列`<input type="checkbox">`，它们都提供`v-model`指令将自己双向绑定到了另一个名为`doneList`数据列表上。在 Vue.js 框架中，如果一组复选框元素被`v-model`指令绑定到了一个列表类型的数据上，那么当这些复选框被选上时，它们的`value`属性值就会被自动添加到这个被绑定的数据列表中。

为了证明被选中的复选框被加入到了`doneList`数据列表中，我还在页面中添加了一个`<div id="done">`元素，并对`doneList`数据列表进行了遍历显示。需要说明的是，用于遍历数据列表的`v-for`指令主要有两种形式：

- **当我们只要遍历列表中的值时**，可以这样写：`v-for="item in dataList"`，这时候数据列表（`dataList`）中的每一项数据就会在遍历过程中逐一被迭代变量（`item`）说读取。
- **当我们需要同时获取列表值及其在列表中的索引时**，可以这样写：`v-for="( item,index ) in dataList"`，这时候数据列表（`dataList`）在遍历过程中，每一项数据的值会被`item`变量读取，而每一项数据的索引会被`index`变量读取。

最后需要说明的是，对于`<div id="done">`元素本身，我使用了`v-if`指令，它的效果与之前的`v-show`指令基本相同，唯一的区别是：`v-if`指令会直接在 DOM 树上增加或删除其所在的元素节点，而`v-show`指令则是单纯通过其所在元素的`style`属性隐藏或显示该元素而已。在执行效率上，`v-show`指令要更高效一些。在这里，我们设置了当`doneList`列表中没有数据时，程序就直接将`<div id="done">`元素从页面中移除，反之则在页面中添加该元素。下面来看一下`02_toDoList`程序运行的效果：

![待办事项](img/todolist.png)

## 第 3 部分：学习与服务器交互
